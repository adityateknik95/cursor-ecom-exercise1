# E-Commerce Data Pipeline

This project simulates an end-to-end e-commerce data workflow. It uses Faker and pandas to generate synthetic datasets, loads them into a SQLite database, and offers a quick analytical report.

## Contents
- `generate_data.py` – creates five CSV datasets (`users`, `products`, `orders`, `order_items`, `reviews`), keeping referential integrity across entities.
- `ingest_db.py` – ingests all CSV files into `ecommerce.db` via `pandas.DataFrame.to_sql` with replace semantics.
- `analyze_data.py` – runs a SQL join across `users`, `orders`, and `order_items` to report the top five customers by total spending.
- `*.csv` – sample data generated by the pipeline.
- `ecommerce.db` – SQLite database populated from the CSV files (if you’ve run ingestion already).

## Prerequisites
- Python 3.9+
- Recommended virtual environment
- Packages: `pandas`, `faker`

Install dependencies:
```
pip install pandas faker
```

## Usage
1. **Generate datasets**
   ```
   py generate_data.py
   ```
   Produces five CSVs in the repo root and prints `Data generated successfully`.

2. **Ingest into SQLite**
   ```
   py ingest_db.py
   ```
   Creates/overwrites `ecommerce.db`, replacing tables if they already exist.

3. **Analyze**
   ```
   py analyze_data.py
   ```
   Outputs the top five users by total spending, based on aggregated order item subtotals.

## Data Model Notes
- `users` ← primary key `user_id`
- `products` ← primary key `product_id`
- `orders` ← foreign key `user_id`
- `order_items` ← foreign keys `order_id`, `product_id`
- `reviews` ← foreign keys `user_id`, `product_id`

Totals in `order_items` recompute order `total_amount` values to ensure consistency between CSVs and the database.

## Troubleshooting
- **Missing pandas or faker** – install via `pip install pandas faker`.
- **Database not found** – run `generate_data.py` followed by `ingest_db.py` before analytics.

